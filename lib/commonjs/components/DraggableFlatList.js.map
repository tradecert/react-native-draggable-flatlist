{"version":3,"names":["AnimatedFlatList","Animated","createAnimatedComponent","FlatList","DraggableFlatListInner","props","useRefs","cellDataRef","containerRef","flatlistRef","keyToIndexRef","propsRef","animationConfigRef","useAnimatedValues","activeCellOffset","activeCellSize","activeIndexAnim","containerSize","scrollOffset","scrollViewSize","spacerIndexAnim","horizontalAnim","placeholderOffset","touchTranslate","autoScrollDistance","panGestureState","isTouchActiveNative","viewableIndexMin","viewableIndexMax","disabled","enabled","useSharedValue","reset","useStableCallback","value","setActiveKey","dragHitSlop","DEFAULT_PROPS","scrollEnabled","activationDistance","activationDistanceProp","useState","activeKey","current","enableLayoutAnimationExperimental","layoutAnimationDisabled","setLayoutAnimationDisabled","keyExtractor","item","index","Error","dataRef","useRef","data","dataHasChanged","map","join","InteractionManager","runAfterInteractions","useEffect","setTimeout","useLayoutEffect","forEach","d","i","key","set","drag","get","cellData","measurements","offset","size","onDragBegin","undefined","onContainerLayout","layout","nativeEvent","width","height","horizontal","onListContentSizeChange","w","h","onContentSizeChange","onContainerTouchStart","onContainerTouchEnd","extraData","useMemo","renderItem","useCallback","panGesture","onRelease","onDragEnd","from","to","newData","splice","onPlaceholderIndexChange","useAnimatedReaction","cur","prev","hasMoved","runOnJS","gestureDisabled","Gesture","Pan","manualActivation","onTouchesMove","evt","state","activate","fail","onBegin","onUpdate","translation","translationX","translationY","onEnd","springTo","withSpring","onTouchesDown","onTouchesUp","hitSlop","activeOffset","activeOffsetX","activeOffsetY","onScroll","onScrollOffsetChange","scrollHandler","useAnimatedScrollHandler","contentOffset","x","y","useAutoScroll","onViewableItemsChanged","info","viewableIndices","viewableItems","filter","isViewable","min","Math","max","containerStyle","renderPlaceholder","CellRendererComponent","simultaneousHandlers","DraggableFlatList","ref","MemoizedInner","typedMemo","React","forwardRef"],"sources":["DraggableFlatList.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from \"react\";\nimport { ListRenderItem, FlatListProps, LayoutChangeEvent, InteractionManager } from \"react-native\";\nimport { FlatList, Gesture, GestureDetector } from \"react-native-gesture-handler\";\nimport Animated, {\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\nimport CellRendererComponent from \"./CellRendererComponent\";\nimport { DEFAULT_PROPS } from \"../constants\";\nimport PlaceholderItem from \"./PlaceholderItem\";\nimport RowItem from \"./RowItem\";\nimport { DraggableFlatListProps } from \"../types\";\nimport PropsProvider from \"../context/propsContext\";\nimport AnimatedValueProvider, { useAnimatedValues } from \"../context/animatedValueContext\";\nimport RefProvider, { useRefs } from \"../context/refContext\";\nimport DraggableFlatListProvider from \"../context/draggableFlatListContext\";\nimport { useAutoScroll } from \"../hooks/useAutoScroll\";\nimport { useStableCallback } from \"../hooks/useStableCallback\";\nimport ScrollOffsetListener from \"./ScrollOffsetListener\";\nimport { typedMemo } from \"../utils\";\n\ntype RNGHFlatListProps<T> = Animated.AnimateProps<\n  FlatListProps<T> & {\n    ref: React.Ref<FlatList<T>>;\n    simultaneousHandlers?: React.Ref<any> | React.Ref<any>[];\n  }\n>;\n\ntype OnViewableItemsChangedCallback<T> = Exclude<FlatListProps<T>[\"onViewableItemsChanged\"], undefined | null>;\n\nconst AnimatedFlatList = (Animated.createAnimatedComponent(FlatList) as unknown) as <T>(\n  props: RNGHFlatListProps<T>\n) => React.ReactElement;\n\nfunction DraggableFlatListInner<T>(props: DraggableFlatListProps<T>) {\n  const { cellDataRef, containerRef, flatlistRef, keyToIndexRef, propsRef, animationConfigRef } = useRefs<T>();\n  const {\n    activeCellOffset,\n    activeCellSize,\n    activeIndexAnim,\n    containerSize,\n    scrollOffset,\n    scrollViewSize,\n    spacerIndexAnim,\n    horizontalAnim,\n    placeholderOffset,\n    touchTranslate,\n    autoScrollDistance,\n    panGestureState,\n    isTouchActiveNative,\n    viewableIndexMin,\n    viewableIndexMax,\n    disabled,\n  } = useAnimatedValues();\n\n  const enabled = useSharedValue(false);\n\n  const reset = useStableCallback(() => {\n    activeIndexAnim.value = -1;\n    spacerIndexAnim.value = -1;\n    touchTranslate.value = 0;\n    activeCellSize.value = -1;\n    activeCellOffset.value = -1;\n    setActiveKey(null);\n  });\n\n  const {\n    dragHitSlop = DEFAULT_PROPS.dragHitSlop,\n    scrollEnabled = DEFAULT_PROPS.scrollEnabled,\n    activationDistance: activationDistanceProp = DEFAULT_PROPS.activationDistance,\n  } = props;\n\n  let [activeKey, setActiveKey] = useState<string | null>(null);\n  const [layoutAnimationDisabled, setLayoutAnimationDisabled] = useState(\n    !propsRef.current.enableLayoutAnimationExperimental\n  );\n\n  const keyExtractor = useStableCallback((item: T, index: number) => {\n    if (!props.keyExtractor) {\n      throw new Error(\"You must provide a keyExtractor to DraggableFlatList\");\n    }\n    return props.keyExtractor(item, index);\n  });\n\n  const dataRef = useRef(props.data);\n  const dataHasChanged = dataRef.current.map(keyExtractor).join(\"\") !== props.data.map(keyExtractor).join(\"\");\n  dataRef.current = props.data;\n  if (dataHasChanged) {\n    // When data changes make sure `activeKey` is nulled out in the same render pass\n    activeKey = null;\n    InteractionManager.runAfterInteractions(() => {\n      reset();\n    });\n  }\n\n  useEffect(() => {\n    if (!propsRef.current.enableLayoutAnimationExperimental) return;\n    if (activeKey) {\n      setLayoutAnimationDisabled(true);\n    } else {\n      // setTimeout result of trial-and-error to determine how long to wait before\n      // re-enabling layout animations so that a drag reorder does not trigger it.\n      setTimeout(() => {\n        setLayoutAnimationDisabled(false);\n      }, 100);\n    }\n  }, [activeKey]);\n\n  useLayoutEffect(() => {\n    props.data.forEach((d, i) => {\n      const key = keyExtractor(d, i);\n      keyToIndexRef.current.set(key, i);\n    });\n  }, [props.data, keyExtractor, keyToIndexRef]);\n\n  const drag = useStableCallback((activeKey: string) => {\n    if (disabled.value) return;\n\n    const index = keyToIndexRef.current.get(activeKey);\n    const cellData = cellDataRef.current.get(activeKey);\n    if (cellData) {\n      activeCellOffset.value = cellData.measurements.offset;\n      activeCellSize.value = cellData.measurements.size;\n    }\n\n    const { onDragBegin } = propsRef.current;\n    if (index !== undefined) {\n      spacerIndexAnim.value = index;\n      activeIndexAnim.value = index;\n      setActiveKey(activeKey);\n      onDragBegin?.(index);\n    }\n  });\n\n  const onContainerLayout = ({ nativeEvent: { layout } }: LayoutChangeEvent) => {\n    const { width, height } = layout;\n    containerSize.value = props.horizontal ? width : height;\n    props.onContainerLayout?.({ layout, containerRef });\n  };\n\n  const onListContentSizeChange = (w: number, h: number) => {\n    scrollViewSize.value = props.horizontal ? w : h;\n    props.onContentSizeChange?.(w, h);\n  };\n\n  const onContainerTouchStart = () => {\n    if (!disabled.value) {\n      isTouchActiveNative.value = true;\n    }\n    return false;\n  };\n\n  const onContainerTouchEnd = () => {\n    isTouchActiveNative.value = false;\n  };\n\n  const extraData = useMemo(\n    () => ({\n      activeKey,\n      extraData: props.extraData,\n    }),\n    [activeKey, props.extraData]\n  );\n\n  const renderItem: ListRenderItem<T> = useCallback(\n    ({ item, index }) => {\n      const key = keyExtractor(item, index);\n      if (index !== keyToIndexRef.current.get(key)) {\n        keyToIndexRef.current.set(key, index);\n      }\n\n      return (\n        <RowItem\n          item={item}\n          itemKey={key}\n          renderItem={props.renderItem}\n          drag={drag}\n          enabled={enabled}\n          panGesture={panGesture}\n          extraData={props.extraData}\n        />\n      );\n    },\n    [props.renderItem, props.extraData, drag, keyExtractor]\n  );\n\n  const onRelease = useStableCallback((index: number) => {\n    props.onRelease?.(index);\n  });\n\n  const onDragEnd = useStableCallback(({ from, to }: { from: number; to: number }) => {\n    const { onDragEnd, data } = props;\n\n    const newData = [...data];\n    if (from !== to) {\n      newData.splice(from, 1);\n      newData.splice(to, 0, data[from]);\n    }\n\n    onDragEnd?.({ from, to, data: newData });\n    setActiveKey(null);\n  });\n\n  const onPlaceholderIndexChange = useStableCallback((index: number) => {\n    props.onPlaceholderIndexChange?.(index);\n  });\n\n  // Handle case where user ends drag without moving their finger.\n  useAnimatedReaction(\n    () => {\n      return isTouchActiveNative.value;\n    },\n    (cur, prev) => {\n      if (cur !== prev && !cur) {\n        const hasMoved = !!touchTranslate.value;\n        if (!hasMoved && activeIndexAnim.value >= 0 && !disabled.value) {\n          runOnJS(onRelease)(activeIndexAnim.value);\n          runOnJS(onDragEnd)({\n            from: activeIndexAnim.value,\n            to: spacerIndexAnim.value,\n          });\n        }\n      }\n    },\n    [isTouchActiveNative, onDragEnd, onRelease]\n  );\n\n  useAnimatedReaction(\n    () => {\n      return spacerIndexAnim.value;\n    },\n    (cur, prev) => {\n      if (prev !== null && cur !== prev && cur >= 0 && prev >= 0) {\n        runOnJS(onPlaceholderIndexChange)(cur);\n      }\n    },\n    [spacerIndexAnim]\n  );\n\n  const gestureDisabled = useSharedValue(false);\n\n  const panGesture = Gesture.Pan()\n    .manualActivation(true)\n    .onTouchesMove((evt, state) => {\n      if (enabled.value) {\n        state.activate();\n      } else {\n        state.fail();\n      }\n    })\n    .onBegin((evt) => {\n      gestureDisabled.value = disabled.value;\n      if (gestureDisabled.value) return;\n      panGestureState.value = evt.state;\n    })\n    .onUpdate((evt) => {\n      if (gestureDisabled.value) return;\n      panGestureState.value = evt.state;\n      const translation = horizontalAnim.value ? evt.translationX : evt.translationY;\n      touchTranslate.value = translation;\n    })\n    .onEnd((evt) => {\n      if (gestureDisabled.value) return;\n      // Set touch val to current translate val\n      isTouchActiveNative.value = false;\n      const translation = horizontalAnim.value ? evt.translationX : evt.translationY;\n\n      touchTranslate.value = translation + autoScrollDistance.value;\n      panGestureState.value = evt.state;\n\n      // Only call onDragEnd if actually dragging a cell\n      if (activeIndexAnim.value === -1 || disabled.value) return;\n      disabled.value = true;\n      runOnJS(onRelease)(activeIndexAnim.value);\n      const springTo = placeholderOffset.value - activeCellOffset.value;\n      touchTranslate.value = withSpring(springTo, animationConfigRef.current, () => {\n        runOnJS(onDragEnd)({\n          from: activeIndexAnim.value,\n          to: spacerIndexAnim.value,\n        });\n        disabled.value = false;\n      });\n    })\n    .onTouchesDown(() => {\n      runOnJS(onContainerTouchStart)();\n    })\n    .onTouchesUp(() => {\n      // Turning this into a worklet causes timing issues. We want it to run\n      // just after the finger lifts.\n      enabled.value = false;\n      runOnJS(onContainerTouchEnd)();\n    });\n\n  if (dragHitSlop) panGesture.hitSlop(dragHitSlop);\n  if (activationDistanceProp) {\n    const activeOffset = [-activationDistanceProp, activationDistanceProp];\n    if (props.horizontal) {\n      panGesture.activeOffsetX(activeOffset);\n    } else {\n      panGesture.activeOffsetY(activeOffset);\n    }\n  }\n\n  const onScroll = useStableCallback((scrollOffset: number) => {\n    props.onScrollOffsetChange?.(scrollOffset);\n  });\n\n  const scrollHandler = useAnimatedScrollHandler(\n    {\n      onScroll: (evt) => {\n        scrollOffset.value = horizontalAnim.value ? evt.contentOffset.x : evt.contentOffset.y;\n        runOnJS(onScroll)(scrollOffset.value);\n      },\n    },\n    [horizontalAnim]\n  );\n\n  useAutoScroll();\n\n  const onViewableItemsChanged = useStableCallback<OnViewableItemsChangedCallback<T>>((info) => {\n    const viewableIndices = info.viewableItems\n      .filter((item) => item.isViewable)\n      .map((item) => item.index)\n      .filter((index): index is number => typeof index === \"number\");\n\n    const min = Math.min(...viewableIndices);\n    const max = Math.max(...viewableIndices);\n    viewableIndexMin.value = min;\n    viewableIndexMax.value = max;\n    props.onViewableItemsChanged?.(info);\n  });\n\n  return (\n    <DraggableFlatListProvider\n      activeKey={activeKey}\n      keyExtractor={keyExtractor}\n      horizontal={!!props.horizontal}\n      layoutAnimationDisabled={layoutAnimationDisabled}\n    >\n      <GestureDetector gesture={panGesture}>\n        <Animated.View style={props.containerStyle} ref={containerRef} onLayout={onContainerLayout}>\n          {props.renderPlaceholder && <PlaceholderItem renderPlaceholder={props.renderPlaceholder} />}\n          <AnimatedFlatList\n            {...props}\n            data={props.data}\n            onViewableItemsChanged={onViewableItemsChanged}\n            CellRendererComponent={CellRendererComponent}\n            ref={flatlistRef}\n            onContentSizeChange={onListContentSizeChange}\n            scrollEnabled={!activeKey && scrollEnabled}\n            renderItem={renderItem}\n            extraData={extraData}\n            keyExtractor={keyExtractor}\n            onScroll={scrollHandler}\n            scrollEventThrottle={16}\n            simultaneousHandlers={props.simultaneousHandlers}\n            removeClippedSubviews={false}\n          />\n          {!!props.onScrollOffsetChange && (\n            <ScrollOffsetListener onScrollOffsetChange={props.onScrollOffsetChange} scrollOffset={scrollOffset} />\n          )}\n        </Animated.View>\n      </GestureDetector>\n    </DraggableFlatListProvider>\n  );\n}\n\nfunction DraggableFlatList<T>(props: DraggableFlatListProps<T>, ref?: React.ForwardedRef<FlatList<T>> | null) {\n  return (\n    <PropsProvider {...props}>\n      <AnimatedValueProvider>\n        <RefProvider flatListRef={ref}>\n          <MemoizedInner {...props} />\n        </RefProvider>\n      </AnimatedValueProvider>\n    </PropsProvider>\n  );\n}\n\nconst MemoizedInner = typedMemo(DraggableFlatListInner);\n\n// Generic forwarded ref type assertion taken from:\n// https://fettblog.eu/typescript-react-generic-forward-refs/#option-1%3A-type-assertion\nexport default React.forwardRef(DraggableFlatList) as <T>(\n  props: DraggableFlatListProps<T> & { ref?: React.ForwardedRef<FlatList<T>> }\n) => ReturnType<typeof DraggableFlatList>;\n"],"mappings":"mbAAA,qDACA,yCACA,uEACA,uFAOA,sFACA,uCACA,0EACA,0DAEA,6EACA,8FACA,0EACA,qGACA,qDACA,6DACA,oFACA,+B,+mCAWA,GAAMA,iBAAgB,CAAIC,8BAAA,CAASC,uBAAT,CAAiCC,mCAAjC,CAA1B,CAIA,QAASC,uBAAT,CAAmCC,KAAnC,CAAqE,6BAC6B,GAAAC,mBAAA,GAD7B,CAC3DC,WAD2D,UAC3DA,WAD2D,CAC9CC,YAD8C,UAC9CA,YAD8C,CAChCC,WADgC,UAChCA,WADgC,CACnBC,aADmB,UACnBA,aADmB,CACJC,QADI,UACJA,QADI,CACMC,kBADN,UACMA,kBADN,wBAmB/D,GAAAC,uCAAA,GAnB+D,CAGjEC,gBAHiE,oBAGjEA,gBAHiE,CAIjEC,cAJiE,oBAIjEA,cAJiE,CAKjEC,eALiE,oBAKjEA,eALiE,CAMjEC,aANiE,oBAMjEA,aANiE,CAOjEC,YAPiE,oBAOjEA,YAPiE,CAQjEC,cARiE,oBAQjEA,cARiE,CASjEC,eATiE,oBASjEA,eATiE,CAUjEC,cAViE,oBAUjEA,cAViE,CAWjEC,iBAXiE,oBAWjEA,iBAXiE,CAYjEC,cAZiE,oBAYjEA,cAZiE,CAajEC,kBAbiE,oBAajEA,kBAbiE,CAcjEC,eAdiE,oBAcjEA,eAdiE,CAejEC,mBAfiE,oBAejEA,mBAfiE,CAgBjEC,gBAhBiE,oBAgBjEA,gBAhBiE,CAiBjEC,gBAjBiE,oBAiBjEA,gBAjBiE,CAkBjEC,QAlBiE,oBAkBjEA,QAlBiE,CAqBnE,GAAMC,QAAO,CAAG,GAAAC,qCAAA,EAAe,KAAf,CAAhB,CAEA,GAAMC,MAAK,CAAG,GAAAC,oCAAA,EAAkB,UAAM,CACpCjB,eAAe,CAACkB,KAAhB,CAAwB,CAAC,CAAzB,CACAd,eAAe,CAACc,KAAhB,CAAwB,CAAC,CAAzB,CACAX,cAAc,CAACW,KAAf,CAAuB,CAAvB,CACAnB,cAAc,CAACmB,KAAf,CAAuB,CAAC,CAAxB,CACApB,gBAAgB,CAACoB,KAAjB,CAAyB,CAAC,CAA1B,CACAC,YAAY,CAAC,IAAD,CAAZ,CACD,CAPa,CAAd,CAvBmE,uBAoC/D9B,KApC+D,CAiCjE+B,WAjCiE,CAiCjEA,WAjCiE,6BAiCnDC,wBAAA,CAAcD,WAjCqC,yCAoC/D/B,KApC+D,CAkCjEiC,aAlCiE,CAkCjEA,aAlCiE,+BAkCjDD,wBAAA,CAAcC,aAlCmC,4CAoC/DjC,KApC+D,CAmCjEkC,kBAnCiE,CAmC7CC,sBAnC6C,gCAmCpBH,wBAAA,CAAcE,kBAnCM,qCAsCnC,GAAAE,eAAA,EAAwB,IAAxB,CAtCmC,qDAsC9DC,SAtC8D,eAsCnDP,YAtCmD,8BAuCL,GAAAM,eAAA,EAC5D,CAAC9B,QAAQ,CAACgC,OAAT,CAAiBC,iCAD0C,CAvCK,sDAuC5DC,uBAvC4D,eAuCnCC,0BAvCmC,eA2CnE,GAAMC,aAAY,CAAG,GAAAd,oCAAA,EAAkB,SAACe,IAAD,CAAUC,KAAV,CAA4B,CACjE,GAAI,CAAC5C,KAAK,CAAC0C,YAAX,CAAyB,CACvB,KAAM,IAAIG,MAAJ,CAAU,sDAAV,CAAN,CACD,CACD,MAAO7C,MAAK,CAAC0C,YAAN,CAAmBC,IAAnB,CAAyBC,KAAzB,CAAP,CACD,CALoB,CAArB,CAOA,GAAME,QAAO,CAAG,GAAAC,aAAA,EAAO/C,KAAK,CAACgD,IAAb,CAAhB,CACA,GAAMC,eAAc,CAAGH,OAAO,CAACR,OAAR,CAAgBY,GAAhB,CAAoBR,YAApB,EAAkCS,IAAlC,CAAuC,EAAvC,IAA+CnD,KAAK,CAACgD,IAAN,CAAWE,GAAX,CAAeR,YAAf,EAA6BS,IAA7B,CAAkC,EAAlC,CAAtE,CACAL,OAAO,CAACR,OAAR,CAAkBtC,KAAK,CAACgD,IAAxB,CACA,GAAIC,cAAJ,CAAoB,CAElBZ,SAAS,CAAG,IAAZ,CACAe,+BAAA,CAAmBC,oBAAnB,CAAwC,UAAM,CAC5C1B,KAAK,GACN,CAFD,EAGD,CAED,GAAA2B,gBAAA,EAAU,UAAM,CACd,GAAI,CAAChD,QAAQ,CAACgC,OAAT,CAAiBC,iCAAtB,CAAyD,OACzD,GAAIF,SAAJ,CAAe,CACbI,0BAA0B,CAAC,IAAD,CAA1B,CACD,CAFD,IAEO,CAGLc,UAAU,CAAC,UAAM,CACfd,0BAA0B,CAAC,KAAD,CAA1B,CACD,CAFS,CAEP,GAFO,CAAV,CAGD,CACF,CAXD,CAWG,CAACJ,SAAD,CAXH,EAaA,GAAAmB,sBAAA,EAAgB,UAAM,CACpBxD,KAAK,CAACgD,IAAN,CAAWS,OAAX,CAAmB,SAACC,CAAD,CAAIC,CAAJ,CAAU,CAC3B,GAAMC,IAAG,CAAGlB,YAAY,CAACgB,CAAD,CAAIC,CAAJ,CAAxB,CACAtD,aAAa,CAACiC,OAAd,CAAsBuB,GAAtB,CAA0BD,GAA1B,CAA+BD,CAA/B,EACD,CAHD,EAID,CALD,CAKG,CAAC3D,KAAK,CAACgD,IAAP,CAAaN,YAAb,CAA2BrC,aAA3B,CALH,EAOA,GAAMyD,KAAI,CAAG,GAAAlC,oCAAA,EAAkB,SAACS,SAAD,CAAuB,CACpD,GAAIb,QAAQ,CAACK,KAAb,CAAoB,OAEpB,GAAMe,MAAK,CAAGvC,aAAa,CAACiC,OAAd,CAAsByB,GAAtB,CAA0B1B,SAA1B,CAAd,CACA,GAAM2B,SAAQ,CAAG9D,WAAW,CAACoC,OAAZ,CAAoByB,GAApB,CAAwB1B,SAAxB,CAAjB,CACA,GAAI2B,QAAJ,CAAc,CACZvD,gBAAgB,CAACoB,KAAjB,CAAyBmC,QAAQ,CAACC,YAAT,CAAsBC,MAA/C,CACAxD,cAAc,CAACmB,KAAf,CAAuBmC,QAAQ,CAACC,YAAT,CAAsBE,IAA7C,CACD,CARmD,GAU5CC,YAV4C,CAU5B9D,QAAQ,CAACgC,OAVmB,CAU5C8B,WAV4C,CAWpD,GAAIxB,KAAK,GAAKyB,SAAd,CAAyB,CACvBtD,eAAe,CAACc,KAAhB,CAAwBe,KAAxB,CACAjC,eAAe,CAACkB,KAAhB,CAAwBe,KAAxB,CACAd,YAAY,CAACO,SAAD,CAAZ,CACA+B,WAAW,MAAX,QAAAA,WAAW,CAAGxB,KAAH,CAAX,CACD,CACF,CAjBY,CAAb,CAmBA,GAAM0B,kBAAiB,CAAG,QAApBA,kBAAoB,MAAoD,IAAlCC,OAAkC,MAAjDC,WAAiD,CAAlCD,MAAkC,IACpEE,MADoE,CAClDF,MADkD,CACpEE,KADoE,CAC7DC,MAD6D,CAClDH,MADkD,CAC7DG,MAD6D,CAE5E9D,aAAa,CAACiB,KAAd,CAAsB7B,KAAK,CAAC2E,UAAN,CAAmBF,KAAnB,CAA2BC,MAAjD,CACA1E,KAAK,CAACsE,iBAAN,cAAAtE,KAAK,CAACsE,iBAAN,CAA0B,CAAEC,MAAM,CAANA,MAAF,CAAUpE,YAAY,CAAZA,YAAV,CAA1B,EACD,CAJD,CAMA,GAAMyE,wBAAuB,CAAG,QAA1BA,wBAA0B,CAACC,CAAD,CAAYC,CAAZ,CAA0B,CACxDhE,cAAc,CAACe,KAAf,CAAuB7B,KAAK,CAAC2E,UAAN,CAAmBE,CAAnB,CAAuBC,CAA9C,CACA9E,KAAK,CAAC+E,mBAAN,cAAA/E,KAAK,CAAC+E,mBAAN,CAA4BF,CAA5B,CAA+BC,CAA/B,EACD,CAHD,CAKA,GAAME,sBAAqB,CAAG,QAAxBA,sBAAwB,EAAM,CAClC,GAAI,CAACxD,QAAQ,CAACK,KAAd,CAAqB,CACnBR,mBAAmB,CAACQ,KAApB,CAA4B,IAA5B,CACD,CACD,MAAO,MAAP,CACD,CALD,CAOA,GAAMoD,oBAAmB,CAAG,QAAtBA,oBAAsB,EAAM,CAChC5D,mBAAmB,CAACQ,KAApB,CAA4B,KAA5B,CACD,CAFD,CAIA,GAAMqD,UAAS,CAAG,GAAAC,cAAA,EAChB,iBAAO,CACL9C,SAAS,CAATA,SADK,CAEL6C,SAAS,CAAElF,KAAK,CAACkF,SAFZ,CAAP,EADgB,CAKhB,CAAC7C,SAAD,CAAYrC,KAAK,CAACkF,SAAlB,CALgB,CAAlB,CAQA,GAAME,WAA6B,CAAG,GAAAC,kBAAA,EACpC,eAAqB,IAAlB1C,KAAkB,OAAlBA,IAAkB,CAAZC,KAAY,OAAZA,KAAY,CACnB,GAAMgB,IAAG,CAAGlB,YAAY,CAACC,IAAD,CAAOC,KAAP,CAAxB,CACA,GAAIA,KAAK,GAAKvC,aAAa,CAACiC,OAAd,CAAsByB,GAAtB,CAA0BH,GAA1B,CAAd,CAA8C,CAC5CvD,aAAa,CAACiC,OAAd,CAAsBuB,GAAtB,CAA0BD,GAA1B,CAA+BhB,KAA/B,EACD,CAED,MACE,8BAAC,gBAAD,EACE,IAAI,CAAED,IADR,CAEE,OAAO,CAAEiB,GAFX,CAGE,UAAU,CAAE5D,KAAK,CAACoF,UAHpB,CAIE,IAAI,CAAEtB,IAJR,CAKE,OAAO,CAAErC,OALX,CAME,UAAU,CAAE6D,UANd,CAOE,SAAS,CAAEtF,KAAK,CAACkF,SAPnB,8EADF,CAWD,CAlBmC,CAmBpC,CAAClF,KAAK,CAACoF,UAAP,CAAmBpF,KAAK,CAACkF,SAAzB,CAAoCpB,IAApC,CAA0CpB,YAA1C,CAnBoC,CAAtC,CAsBA,GAAM6C,UAAS,CAAG,GAAA3D,oCAAA,EAAkB,SAACgB,KAAD,CAAmB,CACrD5C,KAAK,CAACuF,SAAN,cAAAvF,KAAK,CAACuF,SAAN,CAAkB3C,KAAlB,EACD,CAFiB,CAAlB,CAIA,GAAM4C,UAAS,CAAG,GAAA5D,oCAAA,EAAkB,eAAgD,IAA7C6D,KAA6C,OAA7CA,IAA6C,CAAvCC,EAAuC,OAAvCA,EAAuC,IAC1EF,UAD0E,CACtDxF,KADsD,CAC1EwF,SAD0E,CAC/DxC,IAD+D,CACtDhD,KADsD,CAC/DgD,IAD+D,CAGlF,GAAM2C,QAAO,iCAAO3C,IAAP,CAAb,CACA,GAAIyC,IAAI,GAAKC,EAAb,CAAiB,CACfC,OAAO,CAACC,MAAR,CAAeH,IAAf,CAAqB,CAArB,EACAE,OAAO,CAACC,MAAR,CAAeF,EAAf,CAAmB,CAAnB,CAAsB1C,IAAI,CAACyC,IAAD,CAA1B,EACD,CAEDD,SAAS,MAAT,QAAAA,SAAS,CAAG,CAAEC,IAAI,CAAJA,IAAF,CAAQC,EAAE,CAAFA,EAAR,CAAY1C,IAAI,CAAE2C,OAAlB,CAAH,CAAT,CACA7D,YAAY,CAAC,IAAD,CAAZ,CACD,CAXiB,CAAlB,CAaA,GAAM+D,yBAAwB,CAAG,GAAAjE,oCAAA,EAAkB,SAACgB,KAAD,CAAmB,CACpE5C,KAAK,CAAC6F,wBAAN,cAAA7F,KAAK,CAAC6F,wBAAN,CAAiCjD,KAAjC,EACD,CAFgC,CAAjC,CAKA,GAAAkD,0CAAA,iCACQ,CACJ,MAAOzE,oBAAmB,CAACQ,KAA3B,CACD,CAHH,kCAjNOR,mBAiNP,oTAIG0E,GAJH,CAIQC,IAJR,CAIiB,CACb,GAAID,GAAG,GAAKC,IAAR,EAAgB,CAACD,GAArB,CAA0B,CACxB,GAAME,SAAQ,CAAG,CAAC,CAAC/E,cAAc,CAACW,KAAlC,CACA,GAAI,CAACoE,QAAD,EAAatF,eAAe,CAACkB,KAAhB,EAAyB,CAAtC,EAA2C,CAACL,QAAQ,CAACK,KAAzD,CAAgE,CAC9D,GAAAqE,8BAAA,EAAQX,SAAR,EAAmB5E,eAAe,CAACkB,KAAnC,EACA,GAAAqE,8BAAA,EAAQV,SAAR,EAAmB,CACjBC,IAAI,CAAE9E,eAAe,CAACkB,KADL,CAEjB6D,EAAE,CAAE3E,eAAe,CAACc,KAFH,CAAnB,EAID,CACF,CACF,CAfH,6BAhNqBX,cAgNrB,iBA3MYP,eA2MZ,UA9MkDa,QA8MlD,SA5MI0E,8BA4MJ,WA7MYX,SA6MZ,WA5MYC,SA4MZ,iBA1MUzE,eA0MV,siBAgBE,CAACM,mBAAD,CAAsBmE,SAAtB,CAAiCD,SAAjC,CAhBF,EAmBA,GAAAO,0CAAA,iCACQ,CACJ,MAAO/E,gBAAe,CAACc,KAAvB,CACD,CAHH,8BApOOd,eAoOP,2SAIGgF,GAJH,CAIQC,IAJR,CAIiB,CACb,GAAIA,IAAI,GAAK,IAAT,EAAiBD,GAAG,GAAKC,IAAzB,EAAiCD,GAAG,EAAI,CAAxC,EAA6CC,IAAI,EAAI,CAAzD,CAA4D,CAC1D,GAAAE,8BAAA,EAAQL,wBAAR,EAAkCE,GAAlC,EACD,CACF,CARH,sBAnOEG,8BAmOF,0BAnOUL,wBAmOV,+VASE,CAAC9E,eAAD,CATF,EAYA,GAAMoF,gBAAe,CAAG,GAAAzE,qCAAA,EAAe,KAAf,CAAxB,CAEA,GAAM4D,WAAU,CAAGc,kCAAA,CAAQC,GAAR,GAChBC,gBADgB,CACC,IADD,EAEhBC,aAFgB,+BAEDC,GAFC,CAEIC,KAFJ,CAEc,CAC7B,GAAIhF,OAAO,CAACI,KAAZ,CAAmB,CACjB4E,KAAK,CAACC,QAAN,GACD,CAFD,IAEO,CACLD,KAAK,CAACE,IAAN,GACD,CACF,CARgB,sBAlPflF,OAkPe,2SAShBmF,OATgB,+BASPJ,GATO,CASC,CAChBL,eAAe,CAACtE,KAAhB,CAAwBL,QAAQ,CAACK,KAAjC,CACA,GAAIsE,eAAe,CAACtE,KAApB,CAA2B,OAC3BT,eAAe,CAACS,KAAhB,CAAwB2E,GAAG,CAACC,KAA5B,CACD,CAbgB,8BAjPfN,eAiPe,UAlPK3E,QAkPL,iBAhPnBJ,eAgPmB,oXAchByF,QAdgB,+BAcNL,GAdM,CAcE,CACjB,GAAIL,eAAe,CAACtE,KAApB,CAA2B,OAC3BT,eAAe,CAACS,KAAhB,CAAwB2E,GAAG,CAACC,KAA5B,CACA,GAAMK,YAAW,CAAG9F,cAAc,CAACa,KAAf,CAAuB2E,GAAG,CAACO,YAA3B,CAA0CP,GAAG,CAACQ,YAAlE,CACA9F,cAAc,CAACW,KAAf,CAAuBiF,WAAvB,CACD,CAnBgB,8BAlPfX,eAkPe,iBAjPnB/E,eAiPmB,gBAhPCJ,cAgPD,gBA/OnBE,cA+OmB,6cAoBhB+F,KApBgB,+BAoBTT,GApBS,CAoBD,CACd,GAAIL,eAAe,CAACtE,KAApB,CAA2B,OAE3BR,mBAAmB,CAACQ,KAApB,CAA4B,KAA5B,CACA,GAAMiF,YAAW,CAAG9F,cAAc,CAACa,KAAf,CAAuB2E,GAAG,CAACO,YAA3B,CAA0CP,GAAG,CAACQ,YAAlE,CAEA9F,cAAc,CAACW,KAAf,CAAuBiF,WAAW,CAAG3F,kBAAkB,CAACU,KAAxD,CACAT,eAAe,CAACS,KAAhB,CAAwB2E,GAAG,CAACC,KAA5B,CAGA,GAAI9F,eAAe,CAACkB,KAAhB,GAA0B,CAAC,CAA3B,EAAgCL,QAAQ,CAACK,KAA7C,CAAoD,OACpDL,QAAQ,CAACK,KAAT,CAAiB,IAAjB,CACA,GAAAqE,8BAAA,EAAQX,SAAR,EAAmB5E,eAAe,CAACkB,KAAnC,EACA,GAAMqF,SAAQ,CAAGjG,iBAAiB,CAACY,KAAlB,CAA0BpB,gBAAgB,CAACoB,KAA5D,CACAX,cAAc,CAACW,KAAf,CAAuB,GAAAsF,iCAAA,EAAWD,QAAX,CAAqB3G,kBAAkB,CAAC+B,OAAxC,gCAAuD,CAC5E,GAAA4D,8BAAA,EAAQV,SAAR,EAAmB,CACjBC,IAAI,CAAE9E,eAAe,CAACkB,KADL,CAEjB6D,EAAE,CAAE3E,eAAe,CAACc,KAFH,CAAnB,EAIAL,QAAQ,CAACK,KAAT,CAAiB,KAAjB,CACD,CANsB,sBApR3BqE,8BAoR2B,WApRnBV,SAoRmB,iBAnRnB7E,eAmRmB,iBAlRrBI,eAkRqB,UAhR3BS,QAgR2B,2XAAvB,CAOD,CAzCgB,8BAlPf2E,eAkPe,qBAhPnB9E,mBAgPmB,gBA/OCL,cA+OD,gBAvOnBE,cAuOmB,oBA9OkBC,kBA8OlB,iBA7OnBC,eA6OmB,iBArOTT,eAqOS,UAlOjBa,QAkOiB,SAtOjB0E,8BAsOiB,WAzOXX,SAyOW,mBAxOFtE,iBAwOE,kBAxOwBR,gBAwOxB,YAvOI0G,iCAuOJ,6BAvOyB5G,kBAAkB,CAAC+B,OAuO5C,YAtOTkD,SAsOS,iBApOXzE,eAoOW,shCA0ChBqG,aA1CgB,gCA0CI,CACnB,GAAAlB,8BAAA,EAAQlB,qBAAR,IACD,CA5CgB,sBAlPnBkB,8BAkPmB,uBAlPXlB,qBAkPW,iSA6ChBqC,WA7CgB,gCA6CE,CAGjB5F,OAAO,CAACI,KAAR,CAAgB,KAAhB,CACA,GAAAqE,8BAAA,EAAQjB,mBAAR,IACD,CAlDgB,sBAhPnBxD,OAgPmB,SA/OnByE,8BA+OmB,qBA/OXjB,mBA+OW,yTAAnB,CAoDA,GAAIlD,WAAJ,CAAiBuD,UAAU,CAACgC,OAAX,CAAmBvF,WAAnB,EACjB,GAAII,sBAAJ,CAA4B,CAC1B,GAAMoF,aAAY,CAAG,CAAC,CAACpF,sBAAF,CAA0BA,sBAA1B,CAArB,CACA,GAAInC,KAAK,CAAC2E,UAAV,CAAsB,CACpBW,UAAU,CAACkC,aAAX,CAAyBD,YAAzB,EACD,CAFD,IAEO,CACLjC,UAAU,CAACmC,aAAX,CAAyBF,YAAzB,EACD,CACF,CAED,GAAMG,SAAQ,CAAG,GAAA9F,oCAAA,EAAkB,SAACf,YAAD,CAA0B,CAC3Db,KAAK,CAAC2H,oBAAN,cAAA3H,KAAK,CAAC2H,oBAAN,CAA6B9G,YAA7B,EACD,CAFgB,CAAjB,CAIA,GAAM+G,cAAa,CAAG,GAAAC,+CAAA,EACpB,CACEH,QAAQ,+BAAGlB,GAAH,CAAW,CACjB3F,YAAY,CAACgB,KAAb,CAAqBb,cAAc,CAACa,KAAf,CAAuB2E,GAAG,CAACsB,aAAJ,CAAkBC,CAAzC,CAA6CvB,GAAG,CAACsB,aAAJ,CAAkBE,CAApF,CACA,GAAA9B,8BAAA,EAAQwB,QAAR,EAAkB7G,YAAY,CAACgB,KAA/B,EACD,CAHO,2BArTMhB,YAqTN,gBAtTSG,cAsTT,SArTZkF,8BAqTY,UArTJwB,QAqTI,sYADV,CADoB,CAOpB,CAAC1G,cAAD,CAPoB,CAAtB,CAUA,GAAAiH,4BAAA,IAEA,GAAMC,uBAAsB,CAAG,GAAAtG,oCAAA,EAAqD,SAACuG,IAAD,CAAU,CAC5F,GAAMC,gBAAe,CAAGD,IAAI,CAACE,aAAL,CACrBC,MADqB,CACd,SAAC3F,IAAD,QAAUA,KAAI,CAAC4F,UAAf,EADc,EAErBrF,GAFqB,CAEjB,SAACP,IAAD,QAAUA,KAAI,CAACC,KAAf,EAFiB,EAGrB0F,MAHqB,CAGd,SAAC1F,KAAD,QAA4B,OAAOA,MAAP,GAAiB,QAA7C,EAHc,CAAxB,CAKA,GAAM4F,IAAG,CAAGC,IAAI,CAACD,GAAL,OAAAC,IAAI,iCAAQL,eAAR,EAAhB,CACA,GAAMM,IAAG,CAAGD,IAAI,CAACC,GAAL,OAAAD,IAAI,iCAAQL,eAAR,EAAhB,CACA9G,gBAAgB,CAACO,KAAjB,CAAyB2G,GAAzB,CACAjH,gBAAgB,CAACM,KAAjB,CAAyB6G,GAAzB,CACA1I,KAAK,CAACkI,sBAAN,cAAAlI,KAAK,CAACkI,sBAAN,CAA+BC,IAA/B,EACD,CAX8B,CAA/B,CAaA,MACE,8BAAC,iCAAD,EACE,SAAS,CAAE9F,SADb,CAEE,YAAY,CAAEK,YAFhB,CAGE,UAAU,CAAE,CAAC,CAAC1C,KAAK,CAAC2E,UAHtB,CAIE,uBAAuB,CAAEnC,uBAJ3B,6EAME,6BAAC,0CAAD,EAAiB,OAAO,CAAE8C,UAA1B,6EACE,6BAAC,8BAAD,CAAU,IAAV,EAAe,KAAK,CAAEtF,KAAK,CAAC2I,cAA5B,CAA4C,GAAG,CAAExI,YAAjD,CAA+D,QAAQ,CAAEmE,iBAAzE,6EACGtE,KAAK,CAAC4I,iBAAN,EAA2B,6BAAC,wBAAD,EAAiB,iBAAiB,CAAE5I,KAAK,CAAC4I,iBAA1C,8EAD9B,CAEE,6BAAC,gBAAD,0BACM5I,KADN,EAEE,IAAI,CAAEA,KAAK,CAACgD,IAFd,CAGE,sBAAsB,CAAEkF,sBAH1B,CAIE,qBAAqB,CAAEW,8BAJzB,CAKE,GAAG,CAAEzI,WALP,CAME,mBAAmB,CAAEwE,uBANvB,CAOE,aAAa,CAAE,CAACvC,SAAD,EAAcJ,aAP/B,CAQE,UAAU,CAAEmD,UARd,CASE,SAAS,CAAEF,SATb,CAUE,YAAY,CAAExC,YAVhB,CAWE,QAAQ,CAAEkF,aAXZ,CAYE,mBAAmB,CAAE,EAZvB,CAaE,oBAAoB,CAAE5H,KAAK,CAAC8I,oBAb9B,CAcE,qBAAqB,CAAE,KAdzB,+EAFF,CAkBG,CAAC,CAAC9I,KAAK,CAAC2H,oBAAR,EACC,6BAAC,6BAAD,EAAsB,oBAAoB,CAAE3H,KAAK,CAAC2H,oBAAlD,CAAwE,YAAY,CAAE9G,YAAtF,8EAnBJ,CADF,CANF,CADF,CAiCD,CAED,QAASkI,kBAAT,CAA8B/I,KAA9B,CAAgEgJ,GAAhE,CAA8G,CAC5G,MACE,8BAAC,qBAAD,0BAAmBhJ,KAAnB,+EACE,6BAAC,6BAAD,8EACE,6BAAC,mBAAD,EAAa,WAAW,CAAEgJ,GAA1B,6EACE,6BAAC,aAAD,0BAAmBhJ,KAAnB,gFADF,CADF,CADF,CADF,CASD,CAED,GAAMiJ,cAAa,CAAG,GAAAC,gBAAA,EAAUnJ,sBAAV,CAAtB,C,aAIeoJ,cAAA,CAAMC,UAAN,CAAiBL,iBAAjB,C"}